#!/bin/bash
## This is a part of main script: mpm.

# shellcheck disable=SC2154,SC2076,SC2015,SC2164
_DirectVideoDownload() {

    cd "$playlists_dir" || exit 1
    local counter
    __
    printf '%s\n' " ${task}Direct download enabled.${nc}"
    __
    cp -f "$list" "$list"_origin
    mkdir --parents "$videos_dir"/"${list%.*}" \
    && cd "$videos_dir"/"${list%.*}"

    counter=$(grep '^https' -c "$playlists_dir"/"$list")

    while read -r url; do
        
        printf '%s\n' " ${info}$counter file(s) left to download." \
        " Downloading: $(_GetLinkTitle -l)${nc}"
        
        if [[ $url =~ 'youtube.com' && $(_GetLinkTitle -l) =~ '/' ]]; then
            youtube-dl "${ytdlPreset_X[@]}" "$url"
        elif [[ $url =~ 'youtube.com' ]]; then
            youtube-dl \
            --output "$(_GetLinkTitle -l).%(ext)s" \
            "${ytdlPreset_X[@]}" "$url"
        else
            youtube-dl \
            --output "$(_GetLinkTitle -l).%(ext)s" \
            "${ytdlPreset_NC[@]}" "$url"
        fi

        sed -i '2d' "$playlists_dir"/"$list"
        sed -i '1d' "$titles_dir"/"$list".titles
        ((counter--))
        clear

    done < <(grep '^https' "$playlists_dir"/"$list")

    unset url
}