#!/bin/bash
## This is a part of main script: mpm.

_LoadVideo() {

    clear
    __; rm -f "$tmp_dir"/download 2>/dev/null
    echo "${r}Tip: You may want to put this in your mpv.conf:"
    printf '%s\n' "term-playing-msg='Tiltle: \${media-title}'"
    echo -e "Otherwise press I in mpv for more infos.${nc}\n"

    [[ -f $HIGHEST ]] && mpv --ytdl-format=299+251 "$HIGHEST"
    [[ -f $HIGH ]] && mpv --ytdl-format=137+251 "$HIGH"
    [[ -f $MEDIUM ]] && mpv --ytdl-format=22 "$MEDIUM"
    [[ -f $LOW ]] && mpv --ytdl-format=135+251 "$LOW"
    [[ -f $ELSE ]] && mpv "$ELSE"

    TMP=( "$VIDEO_INFO" "$VIDEO_TITLE" "$HIGHEST" "$HIGH" "$MEDIUM" "$LOW" \
            "$ELSE" "$FFOP" "$YTOP" "$tmp_dir/CheckCode" )
    
    if [[ -f "$VIDEO_INFO" ]]; then
        clear
        __
        echo " ${r}Did you launched video(s) from the default list?"
        echo " If so, type ${b}${c}Y${nb} ${r}to preserve temporary video list${nc}" 
        __
        _Prompt " ${g}Temporary video list still exist, KEEP it?:${nc}" || {
            rm -f "${TMP[@]}" 2>/dev/null
            _Menu
        }
        unset {TMP[0],TMP[1]}
        rm -f "${TMP[@]}" 2>/dev/null
        _Menu
    else
        [[ -f $CHOOSE1 ]] && {
            unset {TMP[0],TMP[1],TMP[7],TMP[8],TMP[9]}
            rm -f {"${TMP[@]}","$CHOOSE1"} 2>/dev/null
            _LoadPlaylistMenu
        }
    fi
}
