#!/bin/bash
## This is a part of main script: mpm.

_ConvertAudio() {

    cd "$audios_dir"

    read -rn1 -p ${g}' Select an output format [1 = mp3] [2 = flac] [3 = wav] [4 = ogg]: '${nc} conv
    __
    case "$conv" in
        1)  echo " ${g}Converting downloaded files in mp3...${nc}"
            find . -iname "*.webm" -exec \
            bash -c 'FILE="$1"; \
            ffmpeg -i "${FILE}" \
            -vn -ab 320k -ar 48000 \
            -y "${FILE%.webm}.mp3";' _ '{}' \; 2>"$FFOP"  ;;
        2)  echo " ${g}Converting downloaded files in flac...${nc}"
            find . -iname "*.webm" -exec \
            bash -c 'FILE="$1"; \
            ffmpeg -i "${FILE}" \
            -af aformat=s32:48000 \
            -y "${FILE%.webm}.flac";' _ '{}' \; 2>"$FFOP" ;;
        3)  echo " ${g}Converting downloaded files in wav...${nc}"
            find . -iname "*.webm" -exec \
            bash -c 'FILE="$1"; \
            ffmpeg -i "${FILE}" \
            -acodec pcm_s32le -ar 48000 \
            -y "${FILE%.webm}.wav";' _ '{}' \; 2>"$FFOP" ;;
        4)  echo " ${g}Converting downloaded files in ogg...${nc}"
            find . -iname "*.webm" -exec \
            bash -c 'FILE="$1"; \
            ffmpeg -i "${FILE}" \
            -acodec libvorbis -ar 48000 -ab 320k \
            -y "${FILE%.webm}.ogg";' _ '{}' \; 2>"$FFOP" ;;
        *) echo " ${r}UNKNOWN FORMAT !!! Try again.${color_off}"
            sleep 3s
            clear
            _Menu
        ;;
    esac
    rm ./*.webm
    echo " ${g}Conversion done.${nc}"
    sleep 2
}
