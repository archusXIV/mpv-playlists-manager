#!/bin/bash
## This is a part of main script: mpm.

# shellcheck disable=SC2154
_Menu() {
    # First copy url then select option 1 or 2,
    # the link will be saved in an m3u file.
    while [[ -e $QUEUE ]]; do
        _ResizeWindow
        clear
        _ListsCount
        __
        echo -e "                                           ${mtitle}::MPV-PLAYLISTS-MANAGER $VERSION::"
        echo -e "                                          $(_LittleStars)"
        echo -e "                                     ${info}current theme: $THEME. ${critical}For usage: mpm --help${nc}"
        echo -e "                  ┌─────────────────────────────────────────────────────────────────────────────────────┐"
        echo -e "                  │  1) Create/Add video playlist   6) View default playlist   │  ${info}Tasks for option 4)${nc}:  │"
        [[ $direct_download = yes ]] && echo -e "                  │  2) Create/Add audio playlist   7) Clear all tmp lists     │  direct download: ${task}$direct_download${nc}  │"
        [[ $direct_download = no ]] && echo -e "                  │  2) Create/Add audio playlist   7) Clear all tmp lists     │  direct download:  ${task}$direct_download${nc}  │"
        [[ $automatic_audio_conversion = yes ]] && echo -e "                  │  3) Save as/Delete a playlist   8) Edit a playlist         │  conversion auto: ${task}$automatic_audio_conversion${nc}  │"
        [[ $automatic_audio_conversion = no ]] && echo -e "                  │  3) Save as/Delete a playlist   8) Edit a playlist         │  conversion auto:  ${task}$automatic_audio_conversion${nc}  │"
        if [[ -z $default_conversion_format ]]; then echo -e "                  │  ${info}4)${nc} Play/Download a playlist    9) Edit mpm config (mpmrc) │  audio format:  ${task}unset${nc}  │"; \
        elif [[ $default_conversion_format != flac ]]; then echo -e "                  │  ${info}4)${nc} Play/Download a playlist    9) Edit mpm config (mpmrc) │  audio format:    ${task}$default_conversion_format${nc}  │"; \
        elif [[ $default_conversion_format = flac ]]; then echo -e "                  │  ${info}4)${nc} Play/Download a playlist    9) Edit mpm config (mpmrc) │  audio format:   ${task}$default_conversion_format${nc}  │"; fi
        [[ $quit_after_task = yes ]] && echo -e "                  │  5) Load local folder/files     X) Exit                    │  quit after task: ${task}$quit_after_task${nc}  │"
        [[ $quit_after_task = no ]] && echo -e "                  │  5) Load local folder/files     X) Exit                    │  quit after task:  ${task}$quit_after_task${nc}  │"
        echo -e "                  └─────────────────────────────────────────────────────────────────────────────────────┘"
        [[ -f $tmp_dir/1 ]] \
            && echo -e "                                                     ${info}Select an item${nc}" \
            || echo -e "                                                     ${info}${b}Select an item${nc}${nb}"
        __
        read -rsn 1 mainMenuOptions
        case "$mainMenuOptions" in
            1)  _CopyVideo
                __  ;;
            2)  _CopyAudio
                __  ;;
            3)  _SaveRemove
                __  ;;
            4)  _LoadPlaylist
                __  ;;
            5)  _LoadLocal
                __  ;;
            6)  _ViewUrlInfo -q
                __  ;;
            7)  _DeleteUrl
                __  ;;
            8)  _EditPlaylist
                __  ;;
            9)  _EditMpmConf
                __  ;;
            x|X)    if [[ -f "$AUDIO_URLS" || -f "$VIDEO_URLS" ]]; then
                        _SaveOnExit
                    else
                        nc=$'\e[0m';
                        echo "${nc}"
                        clear
                        exit 0
                    fi
        esac
    done
}