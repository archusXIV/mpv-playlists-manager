#!/bin/bash
## This is a part of main script: mpm.

# shellcheck disable=SC2154
_GetCompleted() {

    cd "$main_dir" || exit 1

    if [[ -n $(find "$audios_dir" "$videos_dir" -name "*.part") ]]; then
        _IfPartsExist -t
    else

        _Prompt -n " ${info}Downloads completed, KEEP playlist?: ${nc}" && {
            echo " ${critical}Don't forget to save it as for future download.${nc}"
            sleep 3

            tempfiles=( "$QUEUE" "$AUDIO_URLS" "$AUDIO_TITLES" \
                        "$VIDEO_URLS" "$VIDEO_TITLES" "$tmp_dir"/DefaultTitles )
            
            for f in "${tempfiles[@]}"; do
                mv -f "$f"_origin "$f"
            done 2>/dev/null
            
            _Menu
            
        }
        
        case "$1" in
            -a)
                if [[ -f "$QUEUE"_origin ]]; then
                    _Remove -q
                else
                    _Remove -a
                fi
            ;;
            -v)
                if [[ -f "$QUEUE"_origin ]]; then
                    _Remove -q
                else
                    _Remove -v
                fi
            ;;
        esac
    fi

}
