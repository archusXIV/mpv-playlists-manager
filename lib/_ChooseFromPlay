#!/bin/bash
## This is a part of main script: mpm.

_ChooseFromPlay() {
    
    if [[ -f "$titles_dir"/"$list".titles ]]; then
        __
        echo -e " ${g}Titles for $list.${nc}\n"
        cat -n "$titles_dir"/"$list".titles
        __
    else
        echo -e " ${g}Getting titles...please wait.${nc}\n"
        mapfile -t CHOOSEDLIST < <(grep -v '#EXTM3U' "$list")
        
        for item in "${CHOOSEDLIST[@]}"; do
            youtube-dl --no-warnings --get-title "$item"
        done > "$titles_dir"/"$list".titles
        cat -n "$titles_dir"/"$list".titles
        __
    fi

    IFS=","; read -a array -p ${g}" Links to load, eg: 3,1,5: "${nc}
    
    for i in ${array[*]}; do
        let "i++"
        sed -n "${i}p" "$list" >> "$CHOOSE1"
    done
    
    read -rsn 1 -p ${g}' load [A]udio, [V]ideo: '${nc} load
    
    case "$load" in
        a|A)
            clear
            mpv \
            --no-video \
            --ytdl-format='bestaudio/best' \
            "$CHOOSE1"
            rm "$CHOOSE1"
            _Menu
        ;;
        v|V)
            clear
            _LoadVideo -c
        ;;
    esac
}

